var _t=Object.create;var Z=Object.defineProperty;var vt=Object.getOwnPropertyDescriptor;var Ut=Object.getOwnPropertyNames;var Rt=Object.getPrototypeOf,It=Object.prototype.hasOwnProperty;var Re=c=>Z(c,"__esModule",{value:!0});var kt=(c,e)=>()=>(e||c((e={exports:{}}).exports,e),e.exports),Dt=(c,e)=>{Re(c);for(var t in e)Z(c,t,{get:e[t],enumerable:!0})},Mt=(c,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Ut(e))!It.call(c,r)&&r!=="default"&&Z(c,r,{get:()=>e[r],enumerable:!(t=vt(e,r))||t.enumerable});return c},T=c=>Mt(Re(Z(c!=null?_t(Rt(c)):{},"default",c&&c.__esModule&&"default"in c?{get:()=>c.default,enumerable:!0}:{value:c,enumerable:!0})),c);var d=(c,e,t)=>new Promise((r,o)=>{var a=s=>{try{b(t.next(s))}catch(x){o(x)}},n=s=>{try{b(t.throw(s))}catch(x){o(x)}},b=s=>s.done?r(s.value):Promise.resolve(s.value).then(a,n);b((t=t.apply(c,e)).next())});var At=kt((as,ee)=>{(function(){"use strict";var c="input is invalid type",e=typeof window=="object",t=e?window:{};t.JS_SHA256_NO_WINDOW&&(e=!1);var r=!e&&typeof self=="object",o=!t.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?t=global:r&&(t=self);var a=!t.JS_SHA256_NO_COMMON_JS&&typeof ee=="object"&&ee.exports,n=typeof define=="function"&&define.amd,b=!t.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",s="0123456789abcdef".split(""),x=[-2147483648,8388608,32768,128],E=[24,16,8,0],G=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],K=["hex","array","digest","arrayBuffer"],C=[];(t.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(i){return Object.prototype.toString.call(i)==="[object Array]"}),b&&(t.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(i){return typeof i=="object"&&i.buffer&&i.buffer.constructor===ArrayBuffer});var Ce=function(i,p){return function(f){return new _(p,!0).update(f)[i]()}},_e=function(i){var p=Ce("hex",i);o&&(p=Ct(p,i)),p.create=function(){return new _(i)},p.update=function(g){return p.create().update(g)};for(var f=0;f<K.length;++f){var u=K[f];p[u]=Ce(u,i)}return p},Ct=function(i,p){var f=require("crypto"),u=require("buffer").Buffer,g=p?"sha224":"sha256",h;u.from&&!t.JS_SHA256_NO_BUFFER_FROM?h=u.from:h=function(m){return new u(m)};var y=function(m){if(typeof m=="string")return f.createHash(g).update(m,"utf8").digest("hex");if(m==null)throw new Error(c);return m.constructor===ArrayBuffer&&(m=new Uint8Array(m)),Array.isArray(m)||ArrayBuffer.isView(m)||m.constructor===u?f.createHash(g).update(h(m)).digest("hex"):i(m)};return y},ve=function(i,p){return function(f,u){return new W(f,p,!0).update(u)[i]()}},Ue=function(i){var p=ve("hex",i);p.create=function(g){return new W(g,i)},p.update=function(g,h){return p.create(g).update(h)};for(var f=0;f<K.length;++f){var u=K[f];p[u]=ve(u,i)}return p};function _(i,p){p?(C[0]=C[16]=C[1]=C[2]=C[3]=C[4]=C[5]=C[6]=C[7]=C[8]=C[9]=C[10]=C[11]=C[12]=C[13]=C[14]=C[15]=0,this.blocks=C):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=i}_.prototype.update=function(i){if(!this.finalized){var p,f=typeof i;if(f!=="string"){if(f==="object"){if(i===null)throw new Error(c);if(b&&i.constructor===ArrayBuffer)i=new Uint8Array(i);else if(!Array.isArray(i)&&(!b||!ArrayBuffer.isView(i)))throw new Error(c)}else throw new Error(c);p=!0}for(var u,g=0,h,y=i.length,m=this.blocks;g<y;){if(this.hashed&&(this.hashed=!1,m[0]=this.block,m[16]=m[1]=m[2]=m[3]=m[4]=m[5]=m[6]=m[7]=m[8]=m[9]=m[10]=m[11]=m[12]=m[13]=m[14]=m[15]=0),p)for(h=this.start;g<y&&h<64;++g)m[h>>2]|=i[g]<<E[h++&3];else for(h=this.start;g<y&&h<64;++g)u=i.charCodeAt(g),u<128?m[h>>2]|=u<<E[h++&3]:u<2048?(m[h>>2]|=(192|u>>6)<<E[h++&3],m[h>>2]|=(128|u&63)<<E[h++&3]):u<55296||u>=57344?(m[h>>2]|=(224|u>>12)<<E[h++&3],m[h>>2]|=(128|u>>6&63)<<E[h++&3],m[h>>2]|=(128|u&63)<<E[h++&3]):(u=65536+((u&1023)<<10|i.charCodeAt(++g)&1023),m[h>>2]|=(240|u>>18)<<E[h++&3],m[h>>2]|=(128|u>>12&63)<<E[h++&3],m[h>>2]|=(128|u>>6&63)<<E[h++&3],m[h>>2]|=(128|u&63)<<E[h++&3]);this.lastByteIndex=h,this.bytes+=h-this.start,h>=64?(this.block=m[16],this.start=h-64,this.hash(),this.hashed=!0):this.start=h}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},_.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var i=this.blocks,p=this.lastByteIndex;i[16]=this.block,i[p>>2]|=x[p&3],this.block=i[16],p>=56&&(this.hashed||this.hash(),i[0]=this.block,i[16]=i[1]=i[2]=i[3]=i[4]=i[5]=i[6]=i[7]=i[8]=i[9]=i[10]=i[11]=i[12]=i[13]=i[14]=i[15]=0),i[14]=this.hBytes<<3|this.bytes>>>29,i[15]=this.bytes<<3,this.hash()}},_.prototype.hash=function(){var i=this.h0,p=this.h1,f=this.h2,u=this.h3,g=this.h4,h=this.h5,y=this.h6,m=this.h7,w=this.blocks,P,R,I,N,S,L,B,z,te,re,X;for(P=16;P<64;++P)S=w[P-15],R=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,S=w[P-2],I=(S>>>17|S<<15)^(S>>>19|S<<13)^S>>>10,w[P]=w[P-16]+R+w[P-7]+I<<0;for(X=p&f,P=0;P<64;P+=4)this.first?(this.is224?(z=300032,S=w[0]-1413257819,m=S-150054599<<0,u=S+24177077<<0):(z=704751109,S=w[0]-210244248,m=S-1521486534<<0,u=S+143694565<<0),this.first=!1):(R=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),I=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),z=i&p,N=z^i&f^X,B=g&h^~g&y,S=m+I+B+G[P]+w[P],L=R+N,m=u+S<<0,u=S+L<<0),R=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),I=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7),te=u&i,N=te^u&p^z,B=m&g^~m&h,S=y+I+B+G[P+1]+w[P+1],L=R+N,y=f+S<<0,f=S+L<<0,R=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),I=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),re=f&u,N=re^f&i^te,B=y&m^~y&g,S=h+I+B+G[P+2]+w[P+2],L=R+N,h=p+S<<0,p=S+L<<0,R=(p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10),I=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),X=p&f,N=X^p&u^re,B=h&y^~h&m,S=g+I+B+G[P+3]+w[P+3],L=R+N,g=i+S<<0,i=S+L<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+i<<0,this.h1=this.h1+p<<0,this.h2=this.h2+f<<0,this.h3=this.h3+u<<0,this.h4=this.h4+g<<0,this.h5=this.h5+h<<0,this.h6=this.h6+y<<0,this.h7=this.h7+m<<0},_.prototype.hex=function(){this.finalize();var i=this.h0,p=this.h1,f=this.h2,u=this.h3,g=this.h4,h=this.h5,y=this.h6,m=this.h7,w=s[i>>28&15]+s[i>>24&15]+s[i>>20&15]+s[i>>16&15]+s[i>>12&15]+s[i>>8&15]+s[i>>4&15]+s[i&15]+s[p>>28&15]+s[p>>24&15]+s[p>>20&15]+s[p>>16&15]+s[p>>12&15]+s[p>>8&15]+s[p>>4&15]+s[p&15]+s[f>>28&15]+s[f>>24&15]+s[f>>20&15]+s[f>>16&15]+s[f>>12&15]+s[f>>8&15]+s[f>>4&15]+s[f&15]+s[u>>28&15]+s[u>>24&15]+s[u>>20&15]+s[u>>16&15]+s[u>>12&15]+s[u>>8&15]+s[u>>4&15]+s[u&15]+s[g>>28&15]+s[g>>24&15]+s[g>>20&15]+s[g>>16&15]+s[g>>12&15]+s[g>>8&15]+s[g>>4&15]+s[g&15]+s[h>>28&15]+s[h>>24&15]+s[h>>20&15]+s[h>>16&15]+s[h>>12&15]+s[h>>8&15]+s[h>>4&15]+s[h&15]+s[y>>28&15]+s[y>>24&15]+s[y>>20&15]+s[y>>16&15]+s[y>>12&15]+s[y>>8&15]+s[y>>4&15]+s[y&15];return this.is224||(w+=s[m>>28&15]+s[m>>24&15]+s[m>>20&15]+s[m>>16&15]+s[m>>12&15]+s[m>>8&15]+s[m>>4&15]+s[m&15]),w},_.prototype.toString=_.prototype.hex,_.prototype.digest=function(){this.finalize();var i=this.h0,p=this.h1,f=this.h2,u=this.h3,g=this.h4,h=this.h5,y=this.h6,m=this.h7,w=[i>>24&255,i>>16&255,i>>8&255,i&255,p>>24&255,p>>16&255,p>>8&255,p&255,f>>24&255,f>>16&255,f>>8&255,f&255,u>>24&255,u>>16&255,u>>8&255,u&255,g>>24&255,g>>16&255,g>>8&255,g&255,h>>24&255,h>>16&255,h>>8&255,h&255,y>>24&255,y>>16&255,y>>8&255,y&255];return this.is224||w.push(m>>24&255,m>>16&255,m>>8&255,m&255),w},_.prototype.array=_.prototype.digest,_.prototype.arrayBuffer=function(){this.finalize();var i=new ArrayBuffer(this.is224?28:32),p=new DataView(i);return p.setUint32(0,this.h0),p.setUint32(4,this.h1),p.setUint32(8,this.h2),p.setUint32(12,this.h3),p.setUint32(16,this.h4),p.setUint32(20,this.h5),p.setUint32(24,this.h6),this.is224||p.setUint32(28,this.h7),i};function W(i,p,f){var u,g=typeof i;if(g==="string"){var h=[],y=i.length,m=0,w;for(u=0;u<y;++u)w=i.charCodeAt(u),w<128?h[m++]=w:w<2048?(h[m++]=192|w>>6,h[m++]=128|w&63):w<55296||w>=57344?(h[m++]=224|w>>12,h[m++]=128|w>>6&63,h[m++]=128|w&63):(w=65536+((w&1023)<<10|i.charCodeAt(++u)&1023),h[m++]=240|w>>18,h[m++]=128|w>>12&63,h[m++]=128|w>>6&63,h[m++]=128|w&63);i=h}else if(g==="object"){if(i===null)throw new Error(c);if(b&&i.constructor===ArrayBuffer)i=new Uint8Array(i);else if(!Array.isArray(i)&&(!b||!ArrayBuffer.isView(i)))throw new Error(c)}else throw new Error(c);i.length>64&&(i=new _(p,!0).update(i).array());var P=[],R=[];for(u=0;u<64;++u){var I=i[u]||0;P[u]=92^I,R[u]=54^I}_.call(this,p,f),this.update(R),this.oKeyPad=P,this.inner=!0,this.sharedMemory=f}W.prototype=new _,W.prototype.finalize=function(){if(_.prototype.finalize.call(this),this.inner){this.inner=!1;var i=this.array();_.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(i),_.prototype.finalize.call(this)}};var M=_e();M.sha256=M,M.sha224=_e(!0),M.sha256.hmac=Ue(),M.sha224.hmac=Ue(!0),a?ee.exports=M:(t.sha256=M.sha256,t.sha224=M.sha224,n&&define(function(){return M}))})()});Dt(exports,{default:()=>qe});var V=T(require("obsidian"));var tt=T(require("obsidian"));var Ie={};var ke={};var De={};var Me={};var ae={domain:"dmain","no sign in":"Imgur no sign in!","not required":"not required",broken:"Emo broken. Check your target","upload error":" upload error","parms error":"Emo need more prams","target hosting":"target hosting","target hosting desc":"Choose your target. Before uploading, make sure you have completely filled in the necessary parameters of the selected platform.","Cloudinary Settings":"Cloudinary Settings","Upload Folder desc":"Folder name to use in Cloudinary. Note, this will be ignored if you have a folder set in your Cloudinary Upload Preset. Not required.","Github Settings":"Github Settings",owner:"owner",repo:"repo",branch:"branch",token:"token",message:"message",path:"path",cdn:"CDN","random filename":"random filename","random filename desc":"Random file names will greatly avoid duplicate file names. If you are sure that you need to use the original file name during this upload, make sure that no duplicate naming will occur under the path you choose.","imgbb Settings":"imgbb Settings",tips:"Tips","tips text":"Imgur anonymous upload will produce the link in this format: ![deletehash](url). [deletehash] is used to delete the image you just uploaded. If your note will be used for publicity, please remember to delete it in time. Authentication upload can be deleted on Imgur.","Imgur Settings":"Imgur Settings","Anonymous Upload":"Anonymous Upload","Anonymous Upload desc":"Files uploaded anonymously will not show in your Imgur account.",imgurid:"ID","built-in id desc":"The built-in ID has a daily usage limit, if it is temporarily invalid, you can use your own client ID here to upload and delete. Not required.",delete:"delete","delete desc":"If you want to delete the image on Imgur, delete it here with the deletehash.","delete btn":"Delete","delete done":"delete done","delete fail":"delete fail",authenticate:"authenticate","auth desc":"Re-auth is required for the change ID to take effect.","imgur account":"Authenticated as: ","auth error":"Authentication failed with error: ","sign in":"sign in","Sign Out":"Sign Out","ImgURL Settings":"ImgURL Settings","SM.MS Settings":"SM.MS Settings","Catbox Settings":"Catbox Settings","Chevereto Settings":"Chevereto Settings","AList Settings":"Alist Settings",username:"username",password:"password",uploadPath:"uploadPath"};var Oe={};var Ne={};var Le={};var Be={};var $e={};var He={};var Ge={};var je={};var Ve={};var ze={};var Je={};var Ye={};var Ke={};var We={};var Xe={};var Ze={};var Qe={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u5F55\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u5F02\u5E38\uFF0C\u68C0\u89C6\u4F60\u7684\u76EE\u6807\u5E73\u53F0\u9009\u62E9","upload error":"\u4E0A\u4F20\u5931\u8D25","parms error":"\u5F53\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C2\u6570\u672A\u586B\u5199\u5B8C\u5168","target hosting":"\u6258\u7BA1\u5E73\u53F0","target hosting desc":"\u9009\u62E9\u76EE\u6807\u3002\u4E0A\u4F20\u4E4B\u524D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u5E73\u53F0\u7684\u5FC5\u8981\u53C2\u6570\u5DF2\u586B\u5199\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u6587\u4EF6\u5939\u540D\u79F0\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9884\u8BBE\u4E86\u6587\u4EF6\u5939\uFF0C\u5219\u4F1A\u5FFD\u7565\u6B64\u9879\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u7528\u6237\u540D",repo:"\u4ED3\u5E93",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u4FE1\u606F",path:"\u8DEF\u5F84",cdn:"CDN","random filename":"\u968F\u673A\u6587\u4EF6\u540D","random filename desc":"\u91C7\u7528\u968F\u673A\u6587\u4EF6\u540D\u5C06\u6781\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u786E\u5B9A\u5728\u4E0A\u4F20\u8FC7\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6587\u4EF6\u540D\uFF0C\u8BF7\u786E\u4FDD\u6240\u9009\u8DEF\u5F84\u4E0B\u4E0D\u4F1A\u51FA\u73B0\u91CD\u540D\u95EE\u9898\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u8D34\u58EB","tips text":"Imgur\u533F\u540D\u4E0A\u4F20\u5C06\u751F\u6210\u4EE5\u4E0B\u683C\u5F0F\u7684\u94FE\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u4E8E\u5220\u9664\u521A\u521A\u4E0A\u4F20\u7684\u56FE\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B14\u8BB0\u4F1A\u88AB\u516C\u5F00\uFF0C\u8BF7\u53CA\u65F6\u5728\u7B14\u8BB0\u4E2D\u5220\u9664deletehash\u3002\u8BA4\u8BC1\u4E0A\u4F20\u53EF\u5728Imgur\u4E0A\u5220\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u4F20","Anonymous Upload desc":"\u533F\u540D\u4E0A\u4F20\u7684\u6587\u4EF6\u4E0D\u4F1A\u663E\u793A\u5728Imgur\u5E10\u6237\u4E2D\u3002",imgurid:"\u5BA2\u6237\u7AEFID","built-in id desc":"\u5185\u7F6EID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u6682\u65F6\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6237\u7AEFID\u4EE5\u8FDB\u884C\u4E0A\u4F20\u548C\u5220\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u5220\u9664","delete desc":"\u5982\u679C\u9700\u8981\u5220\u9664Imgur\u4E0A\u7684\u56FE\u50CF\uFF0C\u8BF7\u5728\u6B64\u5904\u4F7F\u7528deletehash\u5C06\u5176\u5220\u9664\u3002","delete btn":"\u5220\u9664","delete done":"\u5220\u9664\u6210\u529F","delete fail":"\u5220\u9664\u5931\u8D25",authenticate:"\u8BA4\u8BC1","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8BA4\u8BC1\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u5F53\u524D\u7528\u6237\uFF1A ","auth error":"\u8BA4\u8BC1\u9519\u8BEF: ","sign in":"\u767B\u5F55","Sign Out":"\u6CE8\u9500","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6237\u540D",password:"\u5BC6\u7801",uploadPath:"\u4E0A\u4F20\u8DEF\u5F84"};var et={domain:"\u57DF\u540D","no sign in":"Imgur\u672A\u767B\u9304\uFF01","not required":"\u53EF\u4E0D\u586B",broken:"Emo\u5DE5\u4F5C\u7570\u5E38\uFF0C\u6AA2\u8996\u4F60\u7684\u76EE\u6A19\u5E73\u53F0\u9078\u64C7","upload error":"\u4E0A\u50B3\u5931\u6557","parms error":"\u76EE\u524D\u5E73\u53F0\u6240\u9700\u5FC5\u8981\u53C3\u6578\u672A\u586B\u5BEB\u5B8C\u5168","target hosting":"\u8A17\u7BA1\u5E73\u53F0","target hosting desc":"\u9078\u64C7\u76EE\u6A19\u3002\u4E0A\u50B3\u4E4B\u524D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u5E73\u53F0\u7684\u5FC5\u8981\u53C3\u6578\u5DF2\u586B\u5BEB\u5B8C\u6210\u3002","Cloudinary Settings":"Cloudinary\u914D\u7F6E","Upload Folder desc":"\u8981\u5728Cloudinary\u4E2D\u4F7F\u7528\u7684\u8CC7\u6599\u593E\u540D\u7A31\u3002\u6CE8\u610F\uFF0C\u5982\u679C\u5728Cloudinary\u9810\u8A2D\u4E86\u8CC7\u6599\u593E\uFF0C\u5247\u6703\u5FFD\u7565\u6B64\u9805\u3002\u53EF\u4E0D\u586B\u3002","Github Settings":"Github\u914D\u7F6E",owner:"\u4F7F\u7528\u8005\u540D\u7A31",repo:"\u5132\u5B58\u5EAB",branch:"\u5206\u652F",token:"\u4EE4\u724C",message:"\u63D0\u4EA4\u8CC7\u8A0A",path:"\u8DEF\u5F91",cdn:"CDN","random filename":"\u96A8\u6A5F\u6A94\u540D","random filename desc":"\u63A1\u7528\u96A8\u6A5F\u6A94\u540D\u5C07\u6975\u5927\u907F\u514D\u91CD\u540D\u3002\u5982\u679C\u78BA\u5B9A\u5728\u4E0A\u50B3\u904E\u7A0B\u4E2D\u9700\u8981\u4F7F\u7528\u539F\u6A94\u540D\uFF0C\u8ACB\u78BA\u4FDD\u6240\u9078\u8DEF\u5F91\u4E0B\u4E0D\u6703\u51FA\u73FE\u91CD\u540D\u554F\u984C\u3002","imgbb Settings":"imgbb\u914D\u7F6E",tips:"\u5C0F\u6280\u5DE7","tips text":"Imgur\u533F\u540D\u4E0A\u50B3\u5C07\u7522\u751F\u4EE5\u4E0B\u683C\u5F0F\u7684\u93C8\u63A5\uFF1A![deletehash](url)\u3002[deletehash]\u7528\u65BC\u522A\u9664\u525B\u525B\u4E0A\u50B3\u7684\u5F71\u50CF\u3002\u5982\u679C\u60A8\u7684\u7B46\u8A18\u6703\u88AB\u516C\u958B\uFF0C\u8ACB\u53CA\u6642\u5728\u7B46\u8A18\u4E2D\u522A\u9664deletehash\u3002\u8A8D\u8B49\u4E0A\u50B3\u53EF\u5728Imgur\u4E0A\u522A\u9664\u3002","Imgur Settings":"Imgur\u914D\u7F6E","Anonymous Upload":"\u533F\u540D\u4E0A\u50B3","Anonymous Upload desc":"\u533F\u540D\u4E0A\u50B3\u7684\u6A94\u6848\u4E0D\u6703\u986F\u793A\u5728Imgur\u5E33\u6236\u4E2D\u3002",imgurid:"\u5BA2\u6236\u7AEFID","built-in id desc":"\u5167\u5EFAID\u6709\u6BCF\u65E5\u4F7F\u7528\u9650\u5236\uFF0C\u5982\u679C\u66AB\u6642\u5931\u6548\uFF0C\u53EF\u4EE5\u4F7F\u7528\u81EA\u5DF1\u7684\u5BA2\u6236\u7AEFID\u4EE5\u9032\u884C\u4E0A\u50B3\u548C\u522A\u9664\u3002\u53EF\u4E0D\u586B\u3002",delete:"\u522A\u9664","delete desc":"\u5982\u679C\u9700\u8981\u522A\u9664Imgur\u4E0A\u7684\u5F71\u50CF\uFF0C\u8ACB\u5728\u6B64\u8655\u4F7F\u7528deletehash\u5C07\u5176\u522A\u9664\u3002","delete btn":"\u522A\u9664","delete done":"\u522A\u9664\u6210\u529F","delete fail":"\u522A\u9664\u5931\u6557",authenticate:"\u8A8D\u8B49","auth desc":"\u66F4\u6539ID\u9700\u8981\u91CD\u65B0\u8A8D\u8B49\u624D\u80FD\u751F\u6548\u3002","imgur account":"\u76EE\u524D\u4F7F\u7528\u8005\uFF1A ","auth error":"\u8A8D\u8B49\u932F\u8AA4: ","sign in":"\u767B\u9304","Sign Out":"\u8A3B\u92B7","ImgURL Settings":"ImgURL\u914D\u7F6E","SM.MS Settings":"SM.MS\u914D\u7F6E","Catbox Settings":"Catbox\u914D\u7F6E","Chevereto Settings":"Chevereto\u914D\u7F6E","AList Settings":"Alist\u914D\u7F6E",username:"\u7528\u6236\u540D",password:"\u5BC6\u78BC",uploadPath:"\u4E0A\u50B3\u8DEF\u5F91"};var Ot={ar:Ie,cs:ke,da:De,de:Me,en:ae,"en-gb":Oe,es:Ne,fr:Le,hi:Be,id:$e,it:He,ja:Ge,ko:je,nl:Ve,nn:ze,pl:Je,pt:Ye,"pt-br":Ke,ro:We,ru:Xe,tr:Ze,"zh-cn":Qe,"zh-tw":et},oe=Ot[tt.moment.locale()];function l(c){var e;return(e=oe==null?void 0:oe[c])!=null?e:ae[c]}var j=T(require("obsidian"));var rt={required:{userhash:""}};var at={required:{domain:"",token:""}};var ot={required:{name:"",present:""},folder:""};var k;(function(r){r.jsdelivr="jsdelivr",r.statically="statically",r.raw="raw"})(k||(k={}));var st={required:{owner:"",repo:"",branch:"main",token:"",message:"from emo-uploader\xB7Github"},path:"",random:!0,cdn:k.raw};var it={required:{key:""}};var nt={required:{emoid:"4547d4aee97ce8f"},clientid:"",anonymous:!0};var mt={required:{uid:"",token:""}};var dt={required:{token:""}};var ht={required:{domain:"",username:"",password:"",uploadPath:""}};var F;(function(x){x.Github="Github",x.Cloudinary="Cloudinary",x.Catbox="Catbox",x.Imgur="Imgur",x.Smms="SM.MS",x.ImgURL="ImgURL",x.Imgbb="imgbb",x.Chevereto="chevereto",x.Alist="AList"})(F||(F={}));var ut={choice:F.Github,github_parms:st,imgur_parms:nt,cloudinary_parms:ot,smms_parms:dt,imgurl_parms:mt,imgbb_parms:it,catbox_parms:rt,chevereto_parms:at,alist_parms:ht};var Q=T(require("obsidian"));var A=class{constructor(e,t,r){this.kind=e,this.element=t.createDiv(e),this.display(this.element,r),this.element.hide()}update(e){this.kind===e?this.element.show():this.element.hide()}};var se=class extends A{constructor(e,t){super(F.Cloudinary,e,t)}display(e,t){let r=t.config.cloudinary_parms;e.createEl("h3",{text:l("Cloudinary Settings")}),new Q.Setting(e).setName("Cloud Name").addText(o=>{o.setValue(r.required.name).onChange(a=>d(this,null,function*(){r.required.name=a,yield t.saveSettings()}))}),new Q.Setting(e).setName("Upload Presets").addText(o=>{o.setValue(r.required.present).onChange(a=>d(this,null,function*(){r.required.present=a,yield t.saveSettings()}))}),new Q.Setting(e).setName("Upload Folder").setDesc(l("Upload Folder desc")).addText(o=>{o.setPlaceholder("obsidian -> obsidian/pic.png").setValue(r.folder).onChange(a=>d(this,null,function*(){r.folder=a,yield t.saveSettings()}))})}};var O=T(require("obsidian"));var ie=class extends A{constructor(e,t){super(F.Github,e,t)}display(e,t){let r=t.config.github_parms;e.createEl("h3",{text:l("Github Settings")}),new O.Setting(e).setName(l("owner")).addText(a=>{a.setValue(r.required.owner).onChange(n=>d(this,null,function*(){r.required.owner=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("repo")).addText(a=>{a.setValue(r.required.repo).onChange(n=>d(this,null,function*(){r.required.repo=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("branch")).addText(a=>{a.setValue(r.required.branch).onChange(n=>d(this,null,function*(){r.required.branch=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("token")).addText(a=>{a.setValue(r.required.token).onChange(n=>d(this,null,function*(){r.required.token=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("message")).addText(a=>{a.setValue(r.required.message).onChange(n=>d(this,null,function*(){r.required.message=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("path")).setDesc(l("not required")).addText(a=>{a.setPlaceholder("obsidian/ -> obsidian/pic.png").setValue(r.path).onChange(n=>d(this,null,function*(){r.path=n,yield t.saveSettings()}))}),new O.Setting(e).setName(l("random filename")).setDesc(l("random filename desc")).addToggle(a=>{a.setValue(r.random),a.onChange(n=>d(this,null,function*(){r.random=n,yield t.saveSettings()}))});let o=[];for(let a in k)o.push(k[a]);new O.Setting(e).setName(l("cdn")).addDropdown(a=>{o.forEach(n=>{a.addOption(n,n)}),a.setValue(r.cdn).onChange(n=>d(this,null,function*(){r.cdn=n,yield t.saveSettings()}))})}};var pt=T(require("obsidian"));var ne=class extends A{constructor(e,t){super(F.Imgbb,e,t)}display(e,t){let r=t.config.imgbb_parms;e.createEl("h3",{text:l("imgbb Settings")}),new pt.Setting(e).setName("key").addText(o=>{o.setValue(r.required.key).onChange(a=>d(this,null,function*(){r.required.key=a,yield t.saveSettings()}))})}};var me=T(require("obsidian"));var de=class extends A{constructor(e,t){super(F.ImgURL,e,t)}display(e,t){let r=t.config.imgurl_parms;e.createEl("h3",{text:l("ImgURL Settings")}),new me.Setting(e).setName("uid").addText(o=>{o.setValue(r.required.uid).onChange(a=>d(this,null,function*(){r.required.uid=a,yield t.saveSettings()}))}),new me.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(a=>d(this,null,function*(){r.required.token=a,yield t.saveSettings()}))})}};var lt=T(require("obsidian"));var he=class extends A{constructor(e,t){super(F.Smms,e,t)}display(e,t){let r=t.config.smms_parms;e.createEl("h3",{text:l("SM.MS Settings")}),new lt.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(a=>d(this,null,function*(){r.required.token=a,yield t.saveSettings()}))})}};var D=T(require("obsidian"));var H="imgur-access_token",J="4547d4aee97ce8f",ue="loveaimeainixucheng",v="multipart/form-data;boundary="+ue;var pe=class extends A{constructor(e,t){super(F.Imgur,e,t);this.imgurStateText=l("authenticate");this.imgurBtnText=l("sign in");this.authenticated=!1}display(e,t){return d(this,null,function*(){let r=t.config.imgur_parms;e.createEl("h3",{text:l("tips")}),e.createDiv().setText(l("tips text")),e.createEl("h3",{text:l("Imgur Settings")}),new D.Setting(e).setName(l("Anonymous Upload")).setDesc(l("Anonymous Upload desc")).addToggle(a=>{a.setValue(r.anonymous),a.onChange(n=>d(this,null,function*(){r.anonymous=n,yield t.saveSettings()}))}),new D.Setting(e).setName(l("imgurid")).setDesc(l("built-in id desc")).addText(a=>{a.setValue(r.clientid).onChange(n=>d(this,null,function*(){r.clientid=n,yield t.saveSettings()}))});let o="";new D.Setting(e).setName(l("delete")).setDesc(l("delete desc")).addText(a=>{a.setPlaceholder("deletehash").onChange(n=>d(this,null,function*(){o=n}))}).addButton(a=>{a.setCta().setButtonText(l("delete btn")).onClick(()=>{let n="Client-ID ";r.clientid!==""?n+=r.clientid:n+=J;let b={url:"https://api.imgur.com/3/image/"+o,method:"DELETE",headers:{Authorization:n}};(0,D.request)(b).then(()=>{console.log(new D.Notice(l("delete done"),2e3))}).catch(()=>{console.log(new D.Notice(l("delete fail"),2e3))})})}),yield this.checkState(),this.loginState=new D.Setting(e),this.loginState.setName(this.imgurStateText).setDesc(l("auth desc")).addButton(a=>{this.loginBtn=a,this.loginBtn.setCta().setButtonText(this.imgurBtnText).onClick(()=>d(this,null,function*(){if(this.authenticated)localStorage.removeItem(H),this.authenticated=this.drawLogin();else{let n="";r.clientid!==""?n+=r.clientid:n+=J,window.open(`https://api.imgur.com/oauth2/authorize?client_id=${n}&response_type=token`)}}))})})}checkState(){return d(this,null,function*(){try{let e=yield this.getAccountName();e!==l("no sign in")&&(this.imgurStateText=l("imgur account")+`${e} \u2705`,this.imgurBtnText=l("Sign Out"),this.authenticated=!0)}catch(e){console.log(e)}})}getAccountName(){return d(this,null,function*(){let e=localStorage.getItem(H);if(e===null)return l("no sign in");let t=yield fetch("https://api.imgur.com/3/account/me",{headers:new Headers({Authorization:`Bearer ${e}`})});if(!t.ok)throw new Error("Imgur account error");return(yield t.json()).data.url})}drawLogin(){return this.imgurStateText=l("authenticate"),this.imgurBtnText=l("sign in"),this.loginState.setName(this.imgurStateText),this.loginBtn.setButtonText(this.imgurBtnText),!1}};var ct=T(require("obsidian"));var le=class extends A{constructor(e,t){super(F.Catbox,e,t)}display(e,t){let r=t.config.catbox_parms;e.createEl("h3",{text:l("Catbox Settings")}),new ct.Setting(e).setName("userhash").addText(o=>{o.setValue(r.required.userhash).onChange(a=>d(this,null,function*(){r.required.userhash=a,yield t.saveSettings()}))})}};var ce=T(require("obsidian"));var fe=class extends A{constructor(e,t){super(F.Chevereto,e,t)}display(e,t){let r=t.config.chevereto_parms;e.createEl("h3",{text:l("Chevereto Settings")}),new ce.Setting(e).setName(l("domain")).addText(o=>{o.setValue(r.required.domain).onChange(a=>d(this,null,function*(){r.required.domain=a,yield t.saveSettings()}))}),new ce.Setting(e).setName("token").addText(o=>{o.setValue(r.required.token).onChange(a=>d(this,null,function*(){r.required.token=a,yield t.saveSettings()}))})}};var Y=T(require("obsidian"));var ge=class extends A{constructor(e,t){super(F.Alist,e,t)}display(e,t){let r=t.config.alist_parms;e.createEl("h3",{text:l("AList Settings")}),new Y.Setting(e).setName(l("domain")).addText(o=>{o.setPlaceholder("https://alist.example.com").setValue(r.required.domain).onChange(a=>d(this,null,function*(){r.required.domain=a,yield t.saveSettings()}))}),new Y.Setting(e).setName(l("username")).addText(o=>{o.setValue(r.required.username).onChange(a=>d(this,null,function*(){r.required.username=a,yield t.saveSettings()}))}),new Y.Setting(e).setName(l("password")).addText(o=>{o.setValue(r.required.password).onChange(a=>d(this,null,function*(){r.required.password=a,yield t.saveSettings()}))}),new Y.Setting(e).setName(l("uploadPath")).addText(o=>{o.setValue(r.required.uploadPath).onChange(a=>d(this,null,function*(){r.required.uploadPath=a,yield t.saveSettings()}))})}};var xe=class extends j.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t,this.setUpHandler()}display(){let{containerEl:e}=this;e.empty();let t=e.createDiv("cola");t.addClass("emo-cola-div");let o=t.createEl("a",{href:"https://lestua.eu.org/donate"}).createEl("img");o.outerHTML='<?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><line x1="10" y1="16" x2="38" y2="16" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.153 18.1425C14.0703 16.9848 14.9873 16 16.148 16H31.852C33.0127 16 33.9297 16.9848 33.847 18.1425L32.1327 42.1425C32.0579 43.1891 31.187 44 30.1378 44H17.8622C16.813 44 15.9421 43.1891 15.8673 42.1425L14.153 18.1425Z" stroke="currentcolor" stroke-width="4"/><path d="M24 10V6C24 4.89543 24.8954 4 26 4H29" stroke="currentcolor" stroke-width="4" stroke-linecap="round"/><path d="M14.7215 11.6712C14.8822 10.7068 15.7166 10 16.6943 10H31.3057C32.2834 10 33.1178 10.7068 33.2785 11.6712L34 16H14L14.7215 11.6712Z" fill="none" stroke="currentcolor" stroke-width="4"/></svg>',e.createEl("h2",{text:"Emo"});let a=new j.Setting(e).setName(l("target hosting")).setDesc(l("target hosting desc")),n=[];n.push(new ie(e,this.plugin)),n.push(new pe(e,this.plugin)),n.push(new se(e,this.plugin)),n.push(new he(e,this.plugin)),n.push(new de(e,this.plugin)),n.push(new ne(e,this.plugin)),n.push(new le(e,this.plugin)),n.push(new fe(e,this.plugin)),n.push(new ge(e,this.plugin)),n.forEach(s=>{s.update(this.plugin.config.choice)});let b=[];for(let s in F)b.push(F[s]);a.addDropdown(s=>{b.forEach(x=>{s.addOption(x,x)}),s.setValue(this.plugin.config.choice).onChange(x=>d(this,null,function*(){this.plugin.config.choice=x,yield this.plugin.saveSettings(),n.forEach(E=>{E.update(this.plugin.config.choice)})}))})}setUpHandler(){this.plugin.registerObsidianProtocolHandler("emo-imgur-oauth",e=>d(this,null,function*(){if(e.error!==void 0){console.log(new j.Notice(l("auth error")+`${e.error}`));return}let t=e.hash.split("&").map(o=>{let a=o.split("=");return[a[0],a[1]]}),r=new Map(t);localStorage.setItem(H,r.get("access_token")),this.display()}))}};var bt=T(require("obsidian"));function ft(c){return d(this,null,function*(){return yield new Promise((e,t)=>{let r=new FileReader,o;r.readAsArrayBuffer(c),r.onload=()=>{o=r.result},r.onerror=a=>{t(a)},r.onloadend=()=>{e(o)}})})}function gt(c){return d(this,null,function*(){return yield new Promise((e,t)=>{let r=new FileReader,o;r.readAsDataURL(c),r.onload=()=>{o=r.result,o=o.slice(o.indexOf(",")+1)},r.onerror=a=>{t(a)},r.onloadend=()=>{e(o)}})})}function xt(){return Date.parse(new Date().toString()).toString()+(Math.random()*10086).toString(36).slice(-6)}var q=class{isValid(){let e=!0;for(let t in this.parms.required)if(e&&(e=Nt(this.parms.required[t])),!e)return!1;return!0}};function Nt(c){return c.length>0}var be=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t="";if(this.parms.random){let n=e.name.lastIndexOf(".");t=this.parms.path+xt(),t+=n>0?e.name.substring(n):""}else t=this.parms.path+e.name;let r={owner:this.parms.required.owner,repo:this.parms.required.repo,branch:this.parms.required.branch,path:t,message:this.parms.required.message,content:yield gt(e)},o=JSON.stringify(r),a={url:`https://api.github.com/repos/${this.parms.required.owner}/${this.parms.required.repo}/contents/${t}`,method:"PUT",headers:{Authorization:`token ${this.parms.required.token}`},body:o};return yield new Promise((n,b)=>{(0,bt.request)(a).then(()=>{let s;switch(console.log(this.parms.cdn),this.parms.cdn){case k.jsdelivr:s=`![gh](https://cdn.jsdelivr.net/gh/${this.parms.required.owner}/${this.parms.required.repo}@${this.parms.required.branch}/${t})`;break;case k.statically:s=`![gh](https://cdn.statically.io/gh/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;case k.raw:s=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break;default:s=`![gh](https://raw.githubusercontent.com/${this.parms.required.owner}/${this.parms.required.repo}/${this.parms.required.branch}/${t})`;break}n(s)}).catch(s=>{b(s)})})})}};var yt=T(require("obsidian"));var U=class{constructor(){this.randomBoundary=ue;this.body=[],this.boundary="--"+this.randomBoundary,this.endBoundary=this.boundary+"--"}add(e,t){return d(this,null,function*(){let r=this.boundary+`\r
`;if(typeof t=="string"){r+='Content-Disposition: form-data; name="'+e+`"\r
\r
`,r+=t+`\r
`;for(let o=0;o<r.length;o++)this.body.push(r.charCodeAt(o))}else if(t instanceof File){r+='Content-Disposition: form-data; name="'+e+'"; filename="'+t.name+`"\r
`,r+="Content-Type: "+t.type+`\r
\r
`;for(let a=0;a<r.length;a++)this.body.push(r.charCodeAt(a));yield ft(t).then(a=>{let n=new Uint8Array(a);this.body=this.body.concat(Array.prototype.slice.call(n))});let o=`\r
`;for(let a=0;a<o.length;a++)this.body.push(o.charCodeAt(a))}})}getContentType(){return"multipart/form-data; boundary="+this.randomBoundary}getBody(){let e=[];for(let t=0;t<this.endBoundary.length;t++)e.push(this.endBoundary.charCodeAt(t));return this.body=this.body.concat(e),new Uint8Array(this.body).buffer}};var ye=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("uid",this.parms.required.uid),yield t.add("token",this.parms.required.token),yield t.add("file",e);let r={url:"https://www.imgurl.org/api/v2/upload",method:"POST",headers:{"Content-Type":v},body:t.getBody()};return yield new Promise((o,a)=>{(0,yt.request)(r).then(n=>{let s=`![ImgURL](${JSON.parse(n).data.url})`;o(s)}).catch(n=>{a(n)})})})}};var wt=T(require("obsidian"));var we=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("upload_preset",this.parms.required.present),yield t.add("folder",this.parms.folder),yield t.add("file",e);let r={url:`https://api.cloudinary.com/v1_1/${this.parms.required.name}/auto/upload`,method:"POST",headers:{"Content-Type":v},body:t.getBody()};return yield new Promise((o,a)=>{(0,wt.request)(r).then(n=>{let s=`![Cloudinary](${JSON.parse(n).secure_url})`;o(s)}).catch(n=>{a(n)})})})}};var Ft=T(require("obsidian"));var Fe=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("format","json"),yield t.add("smfile",e);let r={url:"https://sm.ms/api/v2/upload",method:"POST",headers:{"Content-Type":v,Authorization:this.parms.required.token},body:t.getBody()};return yield new Promise((o,a)=>{(0,Ft.request)(r).then(n=>{let b=JSON.parse(n),s="";try{s=b.data.url}catch(E){s=b.images}let x=`![SMMS](${s})`;o(x)}).catch(n=>{a(n)})})})}};var St=T(require("obsidian"));var Se=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("key",this.parms.required.key),yield t.add("image",e);let r={url:"https://api.imgbb.com/1/upload",method:"POST",headers:{"Content-Type":v},body:t.getBody()};return yield new Promise((o,a)=>{(0,St.request)(r).then(n=>{let x=`![imgbb](${JSON.parse(n).data.url})`;o(x)}).catch(n=>{a(n)})})})}};var Et=T(require("obsidian"));var Ee=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("image",e);let r;if(this.parms.anonymous){let o="Client-ID ";this.parms.clientid!==""?o+=this.parms.clientid:o+=J,r={url:"https://api.imgur.com/3/upload",method:"POST",headers:{"Content-Type":v,Authorization:o},body:t.getBody()}}else{let o=localStorage.getItem(H);if(o!==null)r={url:"https://api.imgur.com/3/image",method:"POST",headers:{"Content-Type":v,Authorization:`Bearer ${o}`},body:t.getBody()};else return l("no sign in")}return yield new Promise((o,a)=>{(0,Et.request)(r).then(n=>{let b=JSON.parse(n),s=b.data.deletehash,x=b.data.link,E;this.parms.anonymous?E=`![${s}](${x})`:E=`![Imgur](${x})`,o(E)}).catch(n=>{a(n)})})})}};var Pt=T(require("obsidian"));var Pe=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=new U;yield t.add("reqtype","fileupload"),yield t.add("userhash",this.parms.required.userhash),yield t.add("fileToUpload",e);let r={url:"https://catbox.moe/user/api.php",method:"POST",headers:{"Content-Type":v},body:t.getBody()};return yield new Promise((o,a)=>{(0,Pt.request)(r).then(n=>{let b=`![Catbox](${n})`;o(b)}).catch(n=>{a(n)})})})}};var Tt=T(require("obsidian"));var Te=class extends q{constructor(e){super();this.parms=e}formatUrl(e){return!e.startsWith("https://")&&!e.startsWith("http://")&&(e="https://"+e),e.endsWith("/")&&(e=e.slice(0,-1)),e}upload(e){return d(this,null,function*(){let t=this.formatUrl(this.parms.required.domain),r=new U;yield r.add("source",e),yield r.add("key",this.parms.required.token);let o={url:t,method:"POST",headers:{"X-API-Key":this.parms.required.token,"Content-Type":v},body:r.getBody()};return yield new Promise((a,n)=>{(0,Tt.request)(o).then(b=>{let s=JSON.parse(b),x="";x=s.image.url;let E=`![Chevereto](${x})`;a(E)}).catch(b=>{n(b)})})})}};var $=T(require("obsidian"));var qt=T(At()),Ae=class extends q{constructor(e){super();this.parms=e}upload(e){return d(this,null,function*(){let t=yield this.getToken();(yield this.determine(e))!=="success"&&(yield this.mkdirFile(e)),yield this.putFile(e),yield this.refreshDir(e);let o=e.name;e.name==="image.png"&&(o=yield this.renameFile(e));let a=yield this.getFileExtension(e),n={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:t,"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${a}/${o}`})};return yield new Promise((b,s)=>{(0,$.request)(n).then(x=>d(this,null,function*(){let E=JSON.parse(x),G=`![${o}](${E.data.raw_url})`;b(G)})).catch(x=>{s(x)})})})}getToken(){return d(this,null,function*(){let e={url:`${this.parms.required.domain}/api/auth/login/hash`,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.parms.required.username,password:(0,qt.sha256)(this.parms.required.password+"-https://github.com/alist-org/alist")})};return yield new Promise((t,r)=>{(0,$.request)(e).then(o=>{let a=JSON.parse(o);t(a.data.token)}).catch(o=>{r(o)})})})}getFileExtension(e){return d(this,null,function*(){let r=e.name.match(/\.([^.]+)$/);return r!=null?r[1]:""})}determine(e){return d(this,null,function*(){let t=yield this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/get`,method:"POST",headers:{Authorization:yield this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};return yield new Promise((o,a)=>{(0,$.request)(r).then(n=>{let b=JSON.parse(n);o(b.message)}).catch(n=>{a(n)})})})}mkdirFile(e){return d(this,null,function*(){let t=yield this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/mkdir`,method:"POST",headers:{Authorization:yield this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`})};yield(0,$.request)(r)})}putFile(e){return d(this,null,function*(){let t=yield this.getFileExtension(e),r=new U;yield r.add("file",e);let o={url:`${this.parms.required.domain}/api/fs/form`,method:"PUT",headers:{Authorization:yield this.getToken(),"Content-Type":v,"File-Path":encodeURIComponent(`/${this.parms.required.uploadPath}/${t}/${e.name}`),"As-Task":"true"},body:r.getBody()};yield(0,$.request)(o)})}refreshDir(e){return d(this,null,function*(){let t=yield this.getFileExtension(e),r={url:`${this.parms.required.domain}/api/fs/list`,method:"POST",headers:{Authorization:yield this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({path:`/${this.parms.required.uploadPath}/${t}`,page:1,password:"",per_page:0,refresh:!0})};yield(0,$.request)(r)})}renameFile(e){return d(this,null,function*(){let t=yield this.getFileExtension(e),r=new Date,o=b=>b.toString().padStart(2,"0"),a=`${r.getFullYear()}${o(r.getMonth()+1)}${o(r.getDate())}-${o(r.getHours())}:${o(r.getMinutes())}:${o(r.getSeconds())}.${t}`,n={url:`${this.parms.required.domain}/api/fs/rename`,method:"POST",headers:{Authorization:yield this.getToken(),"Content-Type":"application/json"},body:JSON.stringify({name:a,path:`/${this.parms.required.uploadPath}/${t}/${e.name}`})};return yield(0,$.request)(n),a})}};var qe=class extends V.Plugin{onload(){return d(this,null,function*(){console.log("loading  Emo uploader"),yield this.loadSettings(),this.setupPasteHandler(),this.addSettingTab(new xe(this.app,this))})}onunload(){console.log("unloading Emo uploader")}loadSettings(){return d(this,null,function*(){this.config=Object.assign({},ut,yield this.loadData())})}saveSettings(){return d(this,null,function*(){yield this.saveData(this.config)})}setupPasteHandler(){this.registerEvent(this.app.workspace.on("editor-drop",(e,t)=>d(this,null,function*(){let{files:r}=e.dataTransfer;this.startUpload(r,e,t)}))),this.registerEvent(this.app.workspace.on("editor-paste",(e,t)=>d(this,null,function*(){let{files:r}=e.clipboardData;this.startUpload(r,e,t)})))}startUpload(e,t,r){let o;if(e.length>0){switch(this.config.choice){case F.Github:o=new be(this.config.github_parms);break;case F.ImgURL:o=new ye(this.config.imgurl_parms);break;case F.Cloudinary:o=new we(this.config.cloudinary_parms);break;case F.Smms:o=new Fe(this.config.smms_parms);break;case F.Imgbb:o=new Se(this.config.imgbb_parms);break;case F.Imgur:o=new Ee(this.config.imgur_parms);break;case F.Catbox:o=new Pe(this.config.catbox_parms);break;case F.Chevereto:o=new Te(this.config.chevereto_parms);break;case F.Alist:o=new Ae(this.config.alist_parms);break;default:console.log(new V.Notice(l("broken"),2e3));return}if(o.isValid()){t.preventDefault();for(let a of e){let b=`![uploading...](${(Math.random()*10086).toString(36).slice(-6)})
`;r.replaceSelection(b),o.upload(a).then(s=>{let x=a.type.startsWith("image")?0:1;this.replaceText(r,b,s.slice(x))}).catch(s=>{this.replaceText(r,b,`[${this.config.choice} upload error]()`),console.log(new V.Notice(this.config.choice+l("upload error"),2e3)),console.log(s)})}}else console.log(new V.Notice(l("parms error"),2e3)),console.log(o)}}replaceText(e,t,r){t=t.trim();let o=[];for(let a=0;a<e.lineCount();a++)o.push(e.getLine(a));for(let a=0;a<o.length;a++){let n=o[a].indexOf(t);if(n!==-1){let b={line:a,ch:n},s={line:a,ch:n+t.length};e.replaceRange(r,b,s);break}}}};0&&(module.exports={});
/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.10.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2023
 * @license MIT
 */
